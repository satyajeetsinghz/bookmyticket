import{u as q,r,j as e,k as P,L as j,m as w,d as f,n as C,z as $,f as B,q as A,c as I,w as z,g as F}from"./index-CitSJ8Tc.js";function R(s){const[o,x]=r.useState([]),[p,u]=r.useState(!0);return r.useEffect(()=>{if(!s)return;async function c(){u(!0);try{const m=A(I(f,"bookings"),z("userId","==",s)),b=(await F(m)).docs.map(l=>({id:l.id,...l.data()})),g=await Promise.all(b.map(async l=>{let d=null;if(l.movieId)try{const n=await C(w(f,"movies",l.movieId));n.exists()&&(d=n.data())}catch(n){console.error("Error fetching movie:",n)}return{...l,movie:d}}));x(g)}catch(m){console.error("Error fetching bookings:",m)}finally{u(!1)}}c()},[s]),{bookings:o,loading:p}}function W(){const{currentUser:s}=q(),[o,x]=r.useState(""),[p,u]=r.useState(""),[c,m]=r.useState(""),[N,b]=r.useState(""),[g,l]=r.useState(!0),[d,n]=r.useState(!1),[v,y]=r.useState(!1),{bookings:k,loading:M}=R(s==null?void 0:s.uid);r.useEffect(()=>{async function t(){if(s){l(!0);try{const a=w(f,"users",s.uid),h=await C(a);if(h.exists()){const i=h.data();x(i.name||""),u(i.email||""),m(i.bio||""),b(i.profileImage||"https://s3-alpha.figma.com/hub/file/6583978931/d591f10c-3e1c-4ba7-9696-1e483e7fc251-cover.png")}}catch(a){console.error("Error fetching user:",a)}finally{l(!1)}}}t()},[s]);const U=async t=>{if(t.preventDefault(),!!s){n(!0);try{const a=w(f,"users",s.uid);await $(a,{name:o,bio:c}),B.success("Profile updated!"),y(!1)}catch(a){console.error(a),B.error("Failed to update profile")}finally{n(!1)}}};return g||M?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(P,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-neutral-950 to-neutral-900 font-sans text-white",children:[e.jsxs("div",{className:"relative h-48 sm:h-56 md:h-64 bg-neutral-800",children:[e.jsx("img",{src:"https://img.freepik.com/premium-vector/modern-cyan-gradient-color-background-trendy-blue-gradient-color-wallpaper_1199668-178.jpg",alt:"Cover Banner",className:"object-cover w-full h-full brightness-75"}),e.jsx("div",{className:"absolute left-1/2 -bottom-16 transform -translate-x-1/2 w-24 h-24 sm:w-28 sm:h-28 md:w-32 md:h-32 rounded-full border-4 border-neutral-900 shadow-lg overflow-hidden bg-neutral-900",children:e.jsx("img",{src:N,alt:`${o}'s avatar`,className:"object-cover w-full h-full"})})]}),e.jsxs("div",{className:"max-w-4xl mx-auto pt-24 px-4 sm:px-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-semibold tracking-tight",children:o}),e.jsx("p",{className:"text-sm sm:text-base text-neutral-400 mt-1",children:p}),c&&e.jsx("p",{className:"mt-4 text-neutral-300 max-w-xl mx-auto text-sm sm:text-base",children:c})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("button",{onClick:()=>y(!v),className:"px-5 sm:px-6 py-2 rounded-full border border-neutral-700 text-neutral-300 hover:bg-neutral-800 transition text-sm sm:text-base",children:v?"Cancel":"Edit Profile"})}),v&&e.jsxs("form",{onSubmit:U,className:"bg-neutral-900/80 border border-neutral-800 rounded-2xl p-4 sm:p-6 space-y-6 shadow-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-neutral-300 mb-1",children:"Username"}),e.jsx("input",{type:"text",value:o,onChange:t=>x(t.target.value),className:"w-full px-4 py-2.5 bg-neutral-900/60 text-white text-sm border border-neutral-800 rounded-xl",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-neutral-300 mb-1",children:"Bio"}),e.jsx("textarea",{value:c,onChange:t=>m(t.target.value),rows:3,className:"w-full px-4 py-2.5 bg-neutral-900/60 text-white text-sm border border-neutral-800 rounded-xl",placeholder:"Write about you..."})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 bg-blue-600 hover:bg-blue-500 text-white font-medium text-sm sm:text-base rounded-full transition",children:d?"Updating...":"Save Changes"})]}),e.jsx("section",{className:"mt-6 sm:mt-10 max-w-4xl mx-auto",children:e.jsxs("div",{className:"bg-background-DEFAULT bg-apple-dark rounded-xl sm:rounded-2xl shadow-sm border border-neutral-800 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-4 sm:px-6 sm:py-5 border-b border-neutral-800",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Your Tickets"}),e.jsx("p",{className:"text-neutral-400 text-xs sm:text-sm",children:"Upcoming and past bookings"})]}),e.jsx(j,{to:"/movies",className:"inline-flex items-center justify-center px-4 py-2 text-xs sm:text-sm font-medium rounded-full text-white bg-blue-600 hover:bg-blue-700",children:"Book More"})]})}),e.jsx("div",{className:"p-4 sm:p-6",children:k.length===0?e.jsxs("div",{className:"text-center py-8 sm:py-12",children:[e.jsx("svg",{className:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-neutral-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),e.jsx("h3",{className:"mt-3 text-base sm:text-lg font-medium",children:"No bookings yet"}),e.jsx("p",{className:"mt-2 text-sm sm:text-base text-neutral-400 max-w-xs mx-auto",children:"Your movie tickets will appear here after booking"}),e.jsx(j,{to:"/movies",className:"mt-4 inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-blue-600 hover:bg-blue-700",children:"Browse Movies"})]}):e.jsx("ul",{className:"divide-y divide-neutral-800",children:k.map(t=>{var i,S,D,L,E;const a=typeof((i=t.date)==null?void 0:i.toDate)=="function"?t.date.toDate():new Date(t.date),h=a instanceof Date&&!isNaN(a.getTime());return e.jsx("li",{className:"py-4 px-2 sm:px-4 hover:bg-neutral-800/30 transition rounded-xl",children:e.jsx(j,{to:`/booking/${t.id}`,className:"block",children:e.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4",children:[e.jsx("img",{src:((S=t.movie)==null?void 0:S.posterUrl)||"/placeholder.png",alt:((D=t.movie)==null?void 0:D.title)||"Movie",className:"h-20 w-14 sm:h-24 sm:w-16 rounded-lg object-cover flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-base sm:text-lg font-medium truncate",children:((L=t.movie)==null?void 0:L.title)||"Unknown Movie"}),e.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["$",((E=t.totalPrice)==null?void 0:E.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"mt-2 space-y-1 text-xs sm:text-sm text-neutral-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üé¨"}),h?`${a.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})} ‚Ä¢ ${t.time}`:"Date not available"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["üéüÔ∏è ",Array.isArray(t.seats)?t.seats.length:0," seat"]}),e.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-medium ${t.status.toLowerCase()==="confirmed"?"bg-green-900/30 text-green-400":t.status.toLowerCase()==="cancelled"?"bg-red-900/30 text-red-400":"bg-yellow-900/30 text-yellow-400"}`,children:t.status})]})]})]})]})})},t.id)})})})]})})]})]})}export{W as default};
